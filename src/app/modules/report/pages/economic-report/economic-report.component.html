<!-- First Section: Search Info -->
<div class="card card-xl-stretch mb-xl-8">
  <div class="card-header border-0 pt-5">
    <h4 class="card-title align-items-start flex-column">
      <span class="card-label fw-bolder fs-3 mb-1">Buscar por número de control</span>
    </h4>
  </div>

  <div class="card-body py-3">
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center gap-4">
        <!-- Control Number Input -->
        <input type="text" id="controlNumber" name="controlNumber" class="form-control form-control-sm text-end"
          placeholder="CO-0" style="max-width: 180px" [(ngModel)]="controlNumber" />

        <!-- Search Button -->
        <button class="btn btn-outline-primary btn-sm d-flex align-items-center gap-2" (click)="loadReportInfo()">
          <i class="bi bi-search"></i> Buscar
        </button>
      </div>

      <!-- Required Message -->
      <div *ngIf="searchSubmitted && !controlNumber" class="text-danger mt-1 ms-1 small">
        El número de control es obligatorio.
      </div>
    </div>

  </div>

</div>
<!-- end::First Section: Search Info -->

<!-- Second Section: Econocmic Report -->
<div *ngIf="economicReportModel" class="card card-xl-stretch mb-xl-8 mt-2">
  <!-- Card Header -->
  <div class="card-header border-0 pt-5">
    <h3 class="card-title fw-bolder fs-2 mb-1">REPORTE ECONÓMICO</h3>
  </div>

  <!-- Card Body -->
  <div class="card-body pt-0 fs-6">
    <!-- Purchase Info -->
    <div class="table-responsive">
      <table class="table table-bordered align-middle mb-6">
        <tbody>
          <tr>
            <td class="bg-light fw-bold text-nowrap" style="width: 160px;">Nombre de cliente</td>
            <td class="text-nowrap" style="width: 180px;">{{ economicReportModel.purchase.clientName }}</td>
            <td class="bg-light fw-bold text-nowrap" style="width: 160px;">Número de control</td>
            <td class="text-nowrap" style="width: 180px;">{{ economicReportModel.purchase.controlNumber }}</td>
            <td class="bg-light fw-bold text-nowrap" style="width: 160px;">Fecha de compra</td>
            <td class="text-nowrap" style="width: 180px;">{{ economicReportModel.purchase.purchaseDate | date:
              'dd/MM/yyyy' }}</td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Ubicación de piscina</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.shrimpFarmLocation }}</td>
            <td class="bg-light fw-bold text-nowrap">Nombre de Compañía</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.companyName }}</td>
            <td class="bg-light fw-bold text-nowrap">Gramo promedio 1</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.averageGram | number:'1.2-2' }}</td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Nombre de piscina</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.shrimpFarm }}</td>
            <td class="bg-light fw-bold text-nowrap">Periodo</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.period }}</td>
            <td class="bg-light fw-bold text-nowrap">Número de factura</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.invoiceNumber }}</td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Comprador responsable</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.responsibleBuyer }}</td>
            <td class="bg-light fw-bold text-nowrap">Nombre de broker</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.brokerName }}</td>
            <td class="bg-light fw-bold text-nowrap">Estado</td>
            <td class="text-nowrap">{{ purchaseStatus }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- VENTAS -->
    <h5 class="fw-bold border-bottom border-gray-400 pb-2">VENTAS</h5>
    <div class="table-responsive">
      <table class="table table-bordered align-middle mb-6">
        <tbody>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Fecha de venta</td>
            <td class="text-nowrap">{{ economicReportModel.sale.saleDate | date: 'dd/MM/yyyy' }}</td>
            <td class="bg-light fw-bold text-nowrap">Libras netas recibidas</td>
            <td class="text-nowrap">{{ economicReportModel.sale.netPoundsReceived | number:'1.2-2' }}</td>
            <td class="bg-light fw-bold text-nowrap">Total a recibir ($)</td>
            <td class="text-nowrap">{{ economicReportModel.sale.totalToReceive | number:'1.2-2' }}</td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Fecha de recepción</td>
            <td class="text-nowrap">{{ economicReportModel.sale.receptionDate | date: 'dd/MM/yyyy' }}</td>
            <td class="bg-light fw-bold text-nowrap">Libras recibidas cabeza</td>
            <td class="text-nowrap">{{ economicReportModel.sale.wholePoundsReceived | number:'1.2-2' }}</td>
            <td colspan="2"></td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Lote</td>
            <td class="text-nowrap">{{ economicReportModel.sale.batch }}</td>
            <td class="bg-light fw-bold text-nowrap">Libras basura</td>
            <td class="text-nowrap">{{ economicReportModel.sale.trashPounds | number:'1.2-2' }}</td>
            <td colspan="2"></td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Documento</td>
            <td class="text-nowrap">{{ economicReportModel.sale.document }}</td>
            <td class="bg-light fw-bold text-nowrap">Rendimiento</td>
            <td class="text-nowrap">{{ economicReportModel.sale.performance | number:'1.2-2' }}%</td>
            <td colspan="2"></td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Gr. Promedio Lote</td>
            <td class="text-nowrap">{{ economicReportModel.sale.averageBatchGrams | number:'1.2-2' }}</td>
            <td colspan="4"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- COMPRAS -->
    <h5 class="fw-bold border-bottom border-gray-400 pb-2">COMPRAS</h5>
    <div class="table-responsive">
      <table class="table table-bordered align-middle mb-6">
        <tbody>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Gramos promedio 1</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.averageGram | number:'1.2-2' }}</td>
            <td class="bg-light fw-bold text-nowrap">Gramos promedio 2</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.averageGrams2 | number:'1.2-2' }}</td>
            <td class="bg-light fw-bold text-nowrap">Total acordado ($)</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.totalAgreed | number:'1.2-2' }}</td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Precio 1</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.price | number:'1.2-2' }}</td>
            <td class="bg-light fw-bold text-nowrap">Precio 2</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.price2 | number:'1.2-2' }}</td>
            <td colspan="2"></td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Libras compradas 1</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.pounds | number:'1.2-2' }}</td>
            <td class="bg-light fw-bold text-nowrap">Libras compradas 2</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.pounds2 | number:'1.2-2' }}</td>
            <td colspan="2"></td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Total libras compradas</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.totalPoundsPurchased | number:'1.2-2' }}</td>
            <td class="bg-light fw-bold text-nowrap">Total a pagar</td>
            <td class="text-nowrap">{{ economicReportModel.purchase.totalToPay | number:'1.2-2' }}</td>
            <td colspan="2"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- LOGISTICA -->
    <h5 class="fw-bold border-bottom border-gray-400 pb-2">LOGÍSTICA</h5>
    <div class="table-responsive">
      <table class="table table-bordered align-middle mb-6">
        <tbody>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Tipo</td>
            <td class="text-nowrap">{{ logisticsType }}</td>
            <td class="bg-light fw-bold text-nowrap">Gastos personal</td>
            <td class="text-nowrap">{{ economicReportModel.logistics.personnelExpenses | number:'1.2-2' }}</td>
            <td class="bg-light fw-bold text-nowrap">Total a pagar ($)</td>
            <td class="text-nowrap">{{ economicReportModel.logistics.totalToPay | number:'1.2-2' }}</td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Fecha de logística</td>
            <td class="text-nowrap">{{ economicReportModel.logistics.logisticsDate | date: 'dd/MM/yyyy' }}</td>
            <td class="bg-light fw-bold text-nowrap">Gasto productos e insumos</td>
            <td class="text-nowrap">{{ economicReportModel.logistics.productAndSupplyExpenses | number:'1.2-2' }}</td>
            <td colspan="2"></td>
          </tr>
          <tr>
            <td class="bg-light fw-bold text-nowrap">Precio por Libra ($/lb)</td>
            <td class="text-nowrap">
              {{
              economicReportModel.logistics.totalToPay /
              economicReportModel.purchase.pounds
              | number:'1.2-2'
              }}
            </td>
            <td colspan="4"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- UTILIDAD BRUTA -->
    <h5 class="fw-bold text-end mt-4">
      UTILIDAD BRUTA ($):
      <span class="ms-2" [ngClass]="economicReportModel.grossProfit < 0 ? 'text-danger' : 'text-primary'">
        {{ economicReportModel.grossProfit | number:'1.2-2' }}
      </span>
    </h5>
  </div>
</div>


<!-- end::Second Section: Econocmic Report -->
